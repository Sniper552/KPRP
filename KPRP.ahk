#SingleInstance Force
#NoEnv

IniRead, 11MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 11MZ7
IniRead, 21MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 21MZ7
IniRead, 31MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 31MZ7
IniRead, 41MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 41MZ7
IniRead, 51MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 51MZ7
IniRead, 61MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 61MZ7
IniRead, 71MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 71MZ7
IniRead, 81MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 81MZ7
IniRead, 91MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 91MZ7
IniRead, 101MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 101MZ7
IniRead, 111MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 111MZ7
IniRead, 121MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 121MZ7
IniRead, 131MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 131MZ7
IniRead, 141MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 141MZ7
IniRead, 151MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 151MZ7
IniRead, 161MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 161MZ7
IniRead, 171MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 171MZ7
IniRead, 181MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 181MZ7
IniRead, 191MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 191MZ7
IniRead, 201MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 201MZ7
IniRead, 211MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 211MZ7
IniRead, 221MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 221MZ7
IniRead, 231MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 231MZ7
IniRead, 241MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 241MZ7
IniRead, 251MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 251MZ7
IniRead, 261MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 261MZ7
IniRead, 271MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 271MZ7
IniRead, 281MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 281MZ7

IniRead, 11MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 11MZ7
IniRead, 21MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 21MZ7
IniRead, 31MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 31MZ7
IniRead, 41MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 41MZ7
IniRead, 51MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 51MZ7
IniRead, 61MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 61MZ7
IniRead, 71MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 71MZ7
IniRead, 81MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 81MZ7
IniRead, 91MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 91MZ7
IniRead, 101MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 101MZ7
IniRead, 111MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 111MZ7
IniRead, 121MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 121MZ7
IniRead, 131MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 131MZ7
IniRead, 141MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 141MZ7
IniRead, 151MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 151MZ7
IniRead, 161MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 161MZ7
IniRead, 171MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 171MZ7
IniRead, 181MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 181MZ7
IniRead, 191MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 191MZ7
IniRead, 201MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 201MZ7
IniRead, 211MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 211MZ7
IniRead, 221MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 221MZ7
IniRead, 231MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 231MZ7
IniRead, 241MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 241MZ7
IniRead, 251MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 251MZ7
IniRead, 261MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 261MZ7
IniRead, 271MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 271MZ7
IniRead, 281MZ7, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 281MZ7

odinMZ7 = %11MZ7%
dvaMZ7 = %21MZ7%
triMZ7 = %31MZ7%
chetireMZ7 = %41MZ7%
pyatMZ7 = %51MZ7%
shestMZ7 = %61MZ7%
semMZ7 = %71MZ7%
vosemMZ7 = %81MZ7%
devyatMZ7 = %91MZ7%
desyatMZ7 = %101MZ7%
odinadcatMZ7 = %111MZ7%
dvinadcatMZ7 = %121MZ7%
trinadcatMZ7 = %131MZ7%
chetirnadcatMZ7 = %141MZ7%
pyatnadcatMZ7 = %151MZ7%
shestnadcatMZ7 = %161MZ7%
semnagcatMZ7 = %171MZ7%
vosemnagcatMZ7 = %181MZ7%
devyatnadcatMZ7 = %191MZ7%
dvadcatMZ7 = %201MZ7%
dvadcatodinMZ7 = %211MZ7%
dvadcatdvaMZ7 = %221MZ7%
dvadcattriMZ7 = %231MZ7%
dvadcatchetireMZ7 = %241MZ7%
dvadcatpyatMZ7 = %251MZ7%
dvadcatshestMZ7 = %261MZ7%
dvadcatsemMZ7 = %271MZ7%
dvadcatvosemMZ7 = %281MZ7%

Hotkey, %odinMZ7%, Off, UseErrorLevel
Hotkey, %dvaMZ7%, Off, UseErrorLevel
Hotkey, %triMZ7%, Off, UseErrorLevel
Hotkey, %chetireMZ7%, Off, UseErrorLevel
Hotkey, %pyatMZ7%, Off, UseErrorLevel
Hotkey, %shestMZ7%, Off, UseErrorLevel
Hotkey, %semMZ7%, Off, UseErrorLevel
Hotkey, %vosemMZ7%, Off, UseErrorLevel
Hotkey, %devyatMZ7%, Off, UseErrorLevel
Hotkey, %desyatMZ7%, Off, UseErrorLevel
Hotkey, %odinadcatMZ7%, Off, UseErrorLevel
Hotkey, %dvinadcatMZ7%, Off, UseErrorLevel
Hotkey, %trinadcatMZ7%, Off, UseErrorLevel
Hotkey, %chetirnadcatMZ7%, Off, UseErrorLevel
Hotkey, %pyatnadcatMZ7%, Off, UseErrorLevel
Hotkey, %shestnadcatMZ7%, Off, UseErrorLevel
Hotkey, %semnagcatMZ7%, Off, UseErrorLevel
Hotkey, %vosemnagcatMZ7%, Off, UseErrorLevel
Hotkey, %devyatnadcatMZ7%, Off, UseErrorLevel
Hotkey, %dvadcatMZ7%, Off, UseErrorLevel
Hotkey, %dvadcatodinMZ7%, Off, UseErrorLevel
Hotkey, %dvadcatdvaMZ7%, Off, UseErrorLevel
Hotkey, %dvadcattriMZ7%, Off, UseErrorLevel
Hotkey, %dvadcatchetireMZ7%, Off, UseErrorLevel
Hotkey, %dvadcatpyatMZ7%, Off, UseErrorLevel
Hotkey, %dvadcatshestMZ7%, Off, UseErrorLevel
Hotkey, %dvadcatsemMZ7%, Off, UseErrorLevel
Hotkey, %dvadcatvosemMZ7%, Off, UseErrorLevel

Gui, Submit, NoHide
Hotkey, %odinMZ7%, 0001MZ7, On, UseErrorLevel
Hotkey, %dvaMZ7%, 0002MZ7, On, UseErrorLevel
Hotkey, %triMZ7%, 0003MZ7, On, UseErrorLevel
Hotkey, %chetireMZ7%, 0004MZ7, On, UseErrorLevel
Hotkey, %pyatMZ7%, 0005MZ7, On, UseErrorLevel
Hotkey, %shestMZ7%, 0006MZ7, On, UseErrorLevel
Hotkey, %semMZ7%, 0007MZ7, On, UseErrorLevel
Hotkey, %vosemMZ7%, 0008MZ7, On, UseErrorLevel
Hotkey, %devyatMZ7%, 0009MZ7, On, UseErrorLevel
Hotkey, %desyatMZ7%, 0010MZ7, On, UseErrorLevel
Hotkey, %odinadcatMZ7%, 0011MZ7, On, UseErrorLevel
Hotkey, %dvinadcatMZ7%, 0012MZ7, On, UseErrorLevel
Hotkey, %trinadcatMZ7%, 0013MZ7, On, UseErrorLevel
Hotkey, %chetirnadcatMZ7%, 0014MZ7, On, UseErrorLevel
Hotkey, %pyatnadcatMZ7%, 0015MZ7, UseErrorLevel
Hotkey, %shestnadcatMZ7%, 0016MZ7, On, UseErrorLevel
Hotkey, %semnagcatMZ7%, 0017MZ7, On, UseErrorLevel
Hotkey, %vosemnagcatMZ7%, 0018MZ7, On, UseErrorLevel
Hotkey, %devyatnadcatMZ7%, 0019MZ7, On, UseErrorLevel
Hotkey, %dvadcatMZ7%, 0020MZ7, On, UseErrorLevel
Hotkey, %dvadcatodinMZ7%, 0021MZ7, On, UseErrorLevel
Hotkey, %dvadcatdvaMZ7%, 0022MZ7, On, UseErrorLevel
Hotkey, %dvadcattriMZ7%, 0023MZ7, On, UseErrorLevel
Hotkey, %dvadcatchetireMZ7%, 0024, On, UseErrorLevel
Hotkey, %dvadcatpyatMZ7%, 0025MZ7, On, UseErrorLevel
Hotkey, %dvadcatshestMZ7%, 0026MZ7, On, UseErrorLevel
Hotkey, %dvadcatsemMZ7%, 0027MZ7, On, UseErrorLevel
Hotkey, %dvadcatvosemMZ7%, 0028MZ7, On, UseErrorLevel


odin = %11% & %12%
dva = %21% & %22%
tri = %31% & %32%
chetire = %41% & %42%
pyat = %51% & %52%
shest = %61% & %62%
sem = %71% & %72%
vosem = %81% & %82%
devyat = %91% & %92%
desyat = %101% & %102%
odinadcat = %111% & %112%
dvinadcat = %121% & %122%
trinadcat = %131% & %132%
chetirnadcat = %141% & %142%
pyatnadcat = %151% & %152%
shestnadcat = %161% & %162%
semnagcat = %171% & %172%
vosemnagcat = %181% & %182%
devyatnadcat = %191% & %192%
dvadcat = %201% & %202%
dvadcatodin = %211% & %212%
dvadcatdva = %221% & %222%
dvadcattri = %231% & %232%
dvadcatchetire = %241% & %242%
dvadcatpyat = %251% & %252%
dvadcatshest = %261% & %262%
dvadcatsem = %271% & %272%
dvadcatvosem = %281% & %282%
dvadcatdevyat = %291% & %292%
tricat = %301% & %302%
tricatodin = %311% & %312%
tricatdva = %321% & %322%
tricatctri = %331% & %332%
tricathetire = %341% & %342%
tricatpyat = %351% & %352%
tricatshest = %361% & %362%
tricatsem = %371% & %372%
tricatvosem = %381% & %382%
tricatdevyat = %391% & %392%
corok = %401% & %402%
corokodin = %411% & %412%
corokdva = %421% & %422%
coroktri = %431% & %432%
corokhetire = %441% & %442%
corokpyat = %451% & %452%
corokshest = %461% & %462%
coroksem = %471% & %472%
corokvosem = %481% & %482%
corokdevyat = %491% & %492%
pyatdesyat = %501% & %502%
pyatdesyatodin = %511% & %512%
pyatdesyatdva = %521% & %522%
pyatdesyattri = %531% & %532%
pyatdesyathetire = %541% & %542%
pyatdesyatpyat = %551% & %552%
pyatdesyatshest = %561% & %562%
pyatdesyatsem = %571% & %572%
pyatdesyatvosem = %581% & %582%
pyatdesyatdevyat = %591% & %592%
shestdesyat = %601% & %602%
shestdesyatodin = %611% & %612%
shestdesyatdva = %621% & %622%
shestdesyattri = %631% & %632%
shestdesyathetire = %641% & %642%
shestdesyatpyat = %651% & %652%
shestdesyatshest = %661% & %662%
shestdesyatsem = %671% & %672%
shestdesyatvosem = %681% & %682%
shestdesyatdevyat = %691% & %692%
semdesyat = %701% & %702%
semdesyatodin = %711% & %712%
semdesyatdva = %721% & %722%
semdesyattri = %731% & %732%
semdesyathetire = %741% & %742%
semdesyatpyat = %751% & %752%
semdesyatshest = %761% & %762%
semdesyatsem = %771% & %772%
semdesyatvosem = %781% & %782%
semdesyatdevyat = %791% & %792%
vosemdesyat = %801% & %802%
vosemdesyatodin = %811% & %812%
vosemdesyatdva = %821% & %822%
vosemdesyattri = %831% & %832%
vosemdesyathetire = %841% & %842%
vosemdesyatpyat = %851% & %852%
vosemdesyatshest = %861% & %862%
vosemdesyatsem = %871% & %872%
vosemdesyatvosem = %881% & %882%
vosemdesyatdevyat = %891% & %892%
devynosto = %901% & %902%
devynostoodin = %911% & %912%
devynostodva = %921% & %922%
devynostotri = %931% & %932%
devynostohetire = %941% & %942%
devynostopyat = %951% & %952%
devynostoshest = %961% & %962%
devynostosem = %971% & %972%
devynostovosem = %981% & %982%
devynostodevyat = %991% & %992%
sto = %1001% & %1002%
stoodin = %1011% & %1012%
stodva = %1021% & %1022%
stootri = %1031% & %1032%
stohetire = %1041% & %1042%
stopyat = %1051% & %1052%
stoshest = %1061% & %1062%
stosem = %1071% & %1072%
stovosem = %1081% & %1082%
stodevyat = %1091% & %1092%
stodesyat = %1101% & %1102%
stoodinadcat = %1111% & %1112%
stodvinadcat = %1121% & %1122%
stotrinadcat = %1131% & %1132%
stochetirnadcat = %1141% & %1142%
stopyatnadcat = %1151% & %1152%
stoshestnadcat = %1161% & %1162%
stosemnagcat = %1171% & %1172%
stovosemnagcat = %1181% & %1182%
stodevyatnadcat = %1191% & %1192%
stodvadcat = %1201% & %1202%
stodvadcatodin = %1211% & %1212%
stodvadcatdva = %1221% & %1222%
stodvadcattri = %1231% & %1232%
stodvadcathetire = %1241% & %1242%
stodvadcatpyat = %1251% & %1252%
stodvadcatshest = %1261% & %1262%
stodvadcatsem = %1271% & %1272%
stodvadcatsem = %1281% & %1282%


IniRead, JWI, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, JWI
IniRead, TAG, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, TAG
IniRead, Name, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, Name
IniRead, Surname, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, Surname
IniRead, Middle_Name, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, Middle_Name
IniRead, Bol_ro, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, Bol_ro
IniRead, pol, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, pol


IniRead, FonVybor, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, Apps, FonVybor
IniRead, Zaderzhka, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, User, Zaderzhka
IniRead, Zaderzhka_lektsiya, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, User, Zaderzhka_lektsiya
IniRead, Shrift, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, User, Shrift
IniRead, Tsvet, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, User, Tsvet
IniRead, Tsvet_1, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, User, Tsvet_1



if JWI=ERROR
JWI=Студент
if TAG=ERROR
TAG=ГМУ
if Name=ERROR
Name=Не заполнено
if Surname=ERROR
Surname=Не заполнено
if Middle_Name=ERROR
Middle_Name=Не заполнено
if Bol_ro=ERROR
Bol_ro=ГМУ
if Zaderzhka=ERROR
Zaderzhka=3000
if Zaderzhka_lektsiya=ERROR
Zaderzhka_lektsiya=5555
if Shrift=ERROR
Shrift=Arial
if Tsvet=ERROR
Tsvet=FF0000
if Tsvet_1=ERROR
Tsvet_1=000000
if FonVybor=ERROR
FonVybor=
if pol=ERROR
pol=Мужской
if Skrin_1=ERROR
Skrin_1=Включен
if gameFolder=ERROR
gameFolder=

if FonVybor=ERROR
FonVybor=0
oRect := [0, 0, A_ScreenWidth, A_ScreenHeight]
oText := { fontFamily: "Arial"
, fontOptions: "cwhite s10 bold q5"
, textOptions: "x" . A_ScreenWidth - 50 . " y" . A_ScreenHeight - 140 . " right"
, text: "KPRPKRP | " Name " " Surname "`n" Bol "`n" JWI "`n" . A_Year . "." . A_MM . "." . A_DD . "`n" . A_Hour . ":" . A_Min . ":" . A_Sec . "`n"}







if (Pol="Мужской")
{
Floor  =
Female =
}
if (Pol="Женский")
{
Floor = а
Female = ла
}

if (Bol_ro="ЦГБ-Н")
{
Bol_ro_1 =ЦГБ-Н
Bol_ro_2 = Nevskiy.png
Bol_ro_3 =ГБУЗ ЦГБ г. Невский
stol =
tumba=do Шкаф закрыт.
tumba1=say Ваша задача — одновременно открыть шкаф и сказать что-то. И потом закрыть обратно точно также.
}

if (Bol_ro="ЦГБ-П")
{
Bol_ro_1 =ЦГБ-П
Bol_ro_2 = Privolzhsk.png
Bol_ro_3 =ГБУЗ ЦГБ г. Приволжск
stol =do У окна стоит стол.
tumba=say Ваша задача — одновременно взять кружку и сказать что-то. И потом ее поставить обратно точно также.
tumba1=
}

if (Bol_ro="ОКБ-М")
{
Bol_ro_1 =ОКБ-М
Bol_ro_2 =Mirnyy.png
Bol_ro_3 =ГБУЗ ОКБ г. Мирный
stol =
tumba=do Шкаф закрыт.
tumba1=say Ваша задача — одновременно открыть шкаф и сказать что-то. И потом закрыть обратно точно также.
}

if (Bol_ro="ГМУ")
{
Bol_ro_1 =ГМУ-П
Bol_ro_2 = GMU.png
Bol_ro_3 =ГМУ г. Приволжск 
stol =do У окна стоит стол.
tumba=say Ваша задача — одновременно взять кружку и сказать что-то. И потом ее поставить обратно точно также.
tumba1=
}

Menu, Tray, NoStandard
Menu, Tray, Add, Group
Menu, Tray, Rename, Group, КПРП © 2019-2025
Menu, Tray, Add
Menu, Tray, Add, Help
Menu, Tray, Rename, Help, Техническая поддержка
Menu, Tray, Add
Menu, Tray, Add, Bag
Menu, Tray, Rename, Bag, Баг-репорт
Menu, Tray, Add
Menu, Tray, Add, Reload
Menu, Tray, Rename, Reload, Перезапуск
Menu, Tray, Add
Menu, Tray, Add, Свернуть, HideToTray
Menu, Tray, default, Свернуть
Menu, Tray, Add
Menu, Tray, Add, GuiClose
Menu, Tray, Rename, GuiClose,  Выход


ProverkaAdmin()
{

    if(not A_IsAdmin and %0% == 0)
    {
        try
        {
            if(A_IsCompiled)
                Run *RunAs "%A_ScriptFullPath%" /restart
            else
                Run *RunAs "%A_AhkPath%" /restart "%A_ScriptFullPath%"
        }
        ExitApp
    }

}






Proverka()
{
    if (!A_IsCompiled && !InStr(A_AhkPath, "_UIA")) {
        Run % "*uiAccess " A_ScriptFullPath
        ExitApp
    }
}

Ru()
{
    SendMessage, 0x50,, 0x4190419,, A ;
}

En()
{
    SendMessage, 0x50,, 0x4090409,, A ;
}

YAzyk(String) {
    if (RegExMatch(String, "[А-Яа-яЁё]")) {
        Ru()
	} else {
        En()
}
}



Kod(Tsel)
{
    Tsel := StrReplace(Tsel, "#", "{#}")
    Tsel := StrReplace(Tsel, "!", "{!}")
    Tsel := StrReplace(Tsel, "^", "{^}")
    Tsel := StrReplace(Tsel, "+", "{+}")
    Tsel := StrReplace(Tsel, "&", "{&}")

	Return Tsel
}

Codelete(Tsel)
{
    for Key, Value in ["#", "!", "^", "+", "&", "``", ",", ".", ";", "'", "/", "\", "-", "="]
        Tsel := StrReplace(Tsel, Value, "")
	Return Tsel
}

SendChat(Text, BlindBind)
{
    YAzyk(Text)
    Text := Kod(Text)
    SendPlay {F8}^A{Delete}%Text%{Enter}{F8}
    Sleep %BlindBind%
}

ProverkaAdmin()

Proverka()


Greeting()
{
    Morning := 6
    Greeting_Morning := "Доброе утро"
    Day := 12
    Greeting_Day := "Добрый день"
    Evening := 18
    Greeting_Evening := "Добрый вечер"
    Night := 00
    Greeting_Night := "Доброй ночи"
    if !Night
        Night := 24
    if (A_Hour >= Morning and A_Hour < Day)
        Greeting := Greeting_Morning
    else if (A_Hour >= Day and A_Hour < Evening)
        Greeting := Greeting_Day
    else if (A_Hour >= Evening and A_Hour < Night)
        Greeting := Greeting_Evening
    else
        Greeting := Greeting_Night
    return, Greeting
}


KPRPico := "C:\\ProgramData\\KPRP\\KPRP-main\\KPRP.ico"
if !FileExist(KPRPico) {
    MsgBox, Ошибка: Файл %KPRPico% не найден!
} else {
    Menu, Tray, Icon, %KPRPico%
}
selectedFile := "C:\ProgramData\KPRP\KPRP-main\selected.ini"
flagFile := "C:\ProgramData\KPRP\KPRP-main\first_run.flag"  ; Файл для отслеживания первого запуска

; Словарь соответствий (русский -> английская метка)
unitMap := { "РЖД": "UZ", "МЗ": "MZ", "ГУВД": "GUVD", "ГИБДД": "GIBDD", "Армия": "Army" }

; Проверяем, есть ли файл флага первого запуска
if !FileExist(flagFile) {
    ; Если флаг не существует, значит первый запуск
    FileAppend, , %flagFile%  ; Создаем файл флага, чтобы не показывать окно повторно
}

; Проверяем, есть ли сохраненный выбор
if FileExist(selectedFile) {
    FileRead, SelectedItem, %selectedFile%
    SelectedItem := Trim(SelectedItem)  ; Убираем пробелы/переносы строк
    if (SelectedItem != "" && unitMap.HasKey(SelectedItem)) {
        Gosub, % unitMap[SelectedItem]  ; Переходим к нужной метке при старте программы
    }
}

; Показываем интерфейс выбора, если нет сохраненного выбора
if (SelectedItem = "") {
    Gui, 2:Font, S15 C%Tsvet_1% Bold, Consolas
    Gui, 2:Add, DropDownList, vSelectedItem x20 y20 w200, РЖД|МЗ|ГУВД|ГИБДД|Армия
    Gui, 2:Add, Picture, x100 y50 w64 h64 +BackgroundTrans gSaveSelection, C:\ProgramData\KPRP\KPRP-main\Ok_64.png
    Gui, 2:Show, w250 h120, Выбор организации
}
Return

SaveSelection:
    ; Сохраняем выбор
    Gui, 2:Submit
    FileDelete, %selectedFile%
    FileAppend, %SelectedItem%, %selectedFile%
    
    ; Выполняем метку, соответствующую выбранной организации
    if (unitMap.HasKey(SelectedItem)) {
        Gosub, % unitMap[SelectedItem]  ; Переходим к нужной метке
    }

    Gui, 2:Hide  ; Скрываем окно после выбора
Return







UZ:
MsgBox, Функционал на данный момент отсутствует.
FileDelete, C:\ProgramData\KPRP\KPRP-main\selected.ini
Return
GUVD:
MsgBox, Функционал на данный момент отсутствует.
FileDelete, C:\ProgramData\KPRP\KPRP-main\selected.ini
Return
GIBDD:
MsgBox, Функционал на данный момент отсутствует.
FileDelete, C:\ProgramData\KPRP\KPRP-main\selected.ini
Return
Army:
MsgBox, Функционал на данный момент отсутствует.
FileDelete, C:\ProgramData\KPRP\KPRP-main\selected.ini
Return



MZ:
#Include *i C:\ProgramData\KPRP\KPRP-main\KPRPartMZ.ahk



Kon:
Gui, 3:Destroy,
Return


Kon_8:
Gui, 10:Destroy,
Return

Kon_9:
Gui, 11:Destroy,
Return



Vania:

SoundPlay,   C:\ProgramData\KPRP\KPRP-main\muzyka_14.mp3

Gui, 12:Destroy,
Gui, 12:Add, Picture, x0 y0 w96   h672 +BackgroundTrans, C:\ProgramData\KPRP\KPRP-main\Vod_Skrin.png
Gui, 12:Add, Picture, x360 y630 w64 h64   +BackgroundTrans gChange, C:\ProgramData\KPRP\KPRP-main\Ok_64.png

Gui, 12:Font, S15 C%Tsvet_1% Bold, Consolas
Gui, 12:Add, DropDownList, x90 y40 w295 vSkrin_1, %Skrin_1%||Включен|Выключен
Gui, 12:Add, ComboBox, x90 y135 w295 vZaderzhka, %Zaderzhka%||3500|4000|4500|5000|5500|6000|6500|7000

if FonVybor=
Gui, 12:Add, Button, x90 y225 w295 gSvoy_Fon, Выбрать картинку
else
Gui, 12:Font, S15 C%Tsvet_1% Bold, Consolas
Gui, 12:Add, Button, x90 y225 w295 gSvoy_Fon, Установлен свой фон
Gui, 12:Add, ComboBox, x90 y325 w295 vShrift, %Shrift%||Arial|Consolas|Courier New|Comic Sans MS|Lucida Console|MS Sans Serif|Segoe UITimes New Roman
Gui, 12:Add, ComboBox, x90 y420 w295 vTsvet,  %Tsvet%||
Gui, 12:Add, ComboBox, x90 y510 w295 vTsvet_1, %Tsvet_1%||
Gui, 12:Add, ComboBox, x90 y600 w295 vZaderzhka_lektsiya, %Zaderzhka_lektsiya%||4000|4500|5000|5500|6000|6500|7000
Gui, 12:show, center , Настройки
Return

Test:
MsgBox, % 4+32+256, Тестовая версия, Вы действительно хотите запустить тестовую версию?
IfMsgBox, No
    Return

testFile := "C:\ProgramData\KPRP\KPRP-main\Test.ahk" ; Исправленный путь

If !FileExist(testFile) {
    MsgBox, 16, Ошибка, Файл не найден!
    ExitApp
}

Run, %testFile%
ExitApp
Return


Svoy:
MsgBox, % 4+32+256, Удаление данных, Вы действительно, хотите удалить все данные?
	IfMsgBox, No
Return
FileDelete, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini
FileDelete,  C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini
FileDelete,  C:\ProgramData\KPRP\KPRP-main\Dannyye.ini
Return


Group:
MsgBox, % 4+32+256, Сообщество КПРП Вконтакте, Вы действительно хотите посетить наше сообщество?
	IfMsgBox, No
Return
Run https://vk.com/kprpahk
Return

Help:
MsgBox, % 4+32+256, Техническая поддержка, Вы действительно хотите перейти к технической поддержке?
	IfMsgBox, No
Return
Run https://vk.com/im?media=&sel=-187717337
Return




Bag:
MsgBox, % 4+32+256, Баг-репорт, Вы действительно хотите перейти в Баг-репорт?
	IfMsgBox, No
Return
Run https://vk.com/im?media=&sel=-187717337
Return








Change:

SoundPlay,  C:\ProgramData\KPRP\KPRP-main\muzyka_5_1.mp3
Sleep 2500

Gui, Submit

IniWrite, %JWI%, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, JWI
IniWrite, %TAG%, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, TAG
IniWrite, %Name%, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, Name
IniWrite, %Surname%, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, Surname
IniWrite, %Middle_Name%, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, Middle_Name
IniWrite, %Bol_ro%, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, Bol_ro
IniWrite, %Rank%, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, Rank
IniWrite, %TAG_1%, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, TAG_1
IniWrite, %Surname_1%, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, Surname_1
IniWrite, %pol%, C:\ProgramData\KPRP\KPRP-main\Dannyye.ini, User, pol

IniWrite, %Zaderzhka%, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, User, Zaderzhka
IniWrite, %Zaderzhka_lektsiya%, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, User, Zaderzhka_lektsiya
IniWrite, %Skrin_1%, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, User, Skrin_1
IniWrite, %FonVybor%, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, Apps, FonVybor
IniWrite, %Shrift%, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, User, Shrift
IniWrite, %Tsvet%, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, User, Tsvet
IniWrite, %Tsvet_1%, C:\ProgramData\KPRP\KPRP-main\Nastroyki.ini, User, Tsvet_1







if (Pol="Мужской")
{
Floor =
Female =
}
if (Pol="Женский")
{
Floor = а
Female = ла
}



Reload
Return





Reload:
SoundPlay,  C:\ProgramData\KPRP\KPRP-main\muzyka_5_1.mp3
Sleep 2500
Reload
return




Save1:
Gui, 4:SubMit, NoHide

SoundPlay,  C:\ProgramData\KPRP\KPRP-main\muzyka_5_1.mp3
Sleep 2500


IniWrite, %11MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 11MZ7
IniWrite, %21MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 21MZ7
IniWrite, %31MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 31MZ7
IniWrite, %41MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 41MZ7
IniWrite, %51MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 51MZ7
IniWrite, %61MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 61MZ7
IniWrite, %71MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 71MZ7
IniWrite, %81MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 81MZ7
IniWrite, %91MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 91MZ7
IniWrite, %101MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 101MZ7
IniWrite, %111MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 111MZ7
IniWrite, %121MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 121MZ7
IniWrite, %131MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 131MZ7
IniWrite, %141MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 141MZ7
IniWrite, %151MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 151MZ7
IniWrite, %161MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 161MZ7
IniWrite, %171MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 171MZ7
IniWrite, %181MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 181MZ7
IniWrite, %191MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 191MZ7
IniWrite, %201MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 201MZ7
IniWrite, %211MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 211MZ7
IniWrite, %221MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 221MZ7
IniWrite, %231MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 231MZ7
IniWrite, %241MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 241MZ7
IniWrite, %251MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 251MZ7
IniWrite, %261MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 261MZ7
IniWrite, %271MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 271MZ7
IniWrite, %281MZ7%, C:\ProgramData\KPRP\KPRP-main\Raskladka_MZ.ini, Edit, 281MZ7
Reload
return


HideToTray:
if(Hidden)
{
	Menu, Tray, Rename, Развернуть, Свернуть
	Menu, Tray, default, Свернуть
	Gui, 15:Show

} else {
	Menu, Tray, Rename, Свернуть, Развернуть
	Menu, Tray, default, Развернуть

	Gui, 15:Hide
}
Hidden := !Hidden
return


GuiClose:
2GuiClose:
SoundPlay,  C:\ProgramData\KPRP\KPRP-main\muzyka_18.mp3
Sleep 1700
ExitApp


Svoy_Fon:
FileSelectFile, ImagesGUICustom, 3, , , Изображение (*.jpg; *.jpeg; *.png)
FonVybor=%ImagesGUICustom%
MsgBox 48, Внимание, Путь файла обнаружен`n%FonVybor%`nДля отображения необходимо сохранить настройки программы.`nПосле сохранения произведите перезагрузку.
return
screenshotauto:
if (FonVybor=1){
SaveScreenshotToFile(A_ScriptDir . "\Fone\KPRPKRP-" . A_Year . "." . A_MM . "." . A_DD . "-" . A_Hour . "." . A_Min . "." . A_Sec . ".png", oRect, true, oText)
}
return


SaveScreenshotToFile(filePath, oRect := "", captureCursor := true, oText := "")  {
for k, v in ["x", "y", "w", "h"]
if ( (%v% := oRect[k]) + 0 = "" && empty := true )
break
if empty  {
Sysget, x, 76
Sysget, y, 77
Sysget, w, 78
Sysget, h, 79
}
hBitmap := GetHBitmapFromScreen(x, y, w, h, captureCursor, oText)
gdip := new GDIplus
pBitmap := gdip.BitmapFromHBitmap(hBitmap)
DllCall("DeleteObject", Ptr, hBitmap)
gdip.SaveBitmapToFile(pBitmap, filePath)
gdip.DisposeImage(pBitmap)
}
GetHBitmapFromScreen(x, y, w, h, captureCursor, oText)  {
hDC := DllCall("GetDC", Ptr, 0, Ptr)
hBM := DllCall("CreateCompatibleBitmap", Ptr, hDC, Int, w, Int, h, Ptr)
hMDC := DllCall("CreateCompatibleDC", Ptr, hDC, Ptr)
oBM := DllCall("SelectObject", Ptr, hMDC, Ptr, hBM, Ptr)
DllCall("BitBlt", Ptr, hMDC, Int, 0, Int, 0, Int, w, Int, h, Ptr, hDC, Int, x, Int, y, UInt, 0x00CC0020)
( captureCursor && CaptureCursor(hMDC, x, y) )
( IsObject(oText) && DrawText(hMDC, oText) )
DllCall("SelectObject", Ptr, hMDC, Ptr, oBM)
DllCall("DeleteDC", Ptr, hMDC)
DllCall("ReleaseDC", Ptr, 0, Ptr, hDC)
Return hBM
}
CaptureCursor(hDC, x, y)  {
VarSetCapacity(CURSORINFO, szCI := 4*2 + A_PtrSize + 8, 0)
NumPut(szCI, CURSORINFO)
DllCall("GetCursorInfo", Ptr, &CURSORINFO)
bShow   := NumGet(CURSORINFO, 4, "UInt")
hCursor := NumGet(CURSORINFO, 4*2)
xCursor := NumGet(CURSORINFO, 4*2 + A_PtrSize, "Int")
yCursor := NumGet(CURSORINFO, 4*2 + A_PtrSize + 4, "Int")
if bShow && hCursor := DllCall("CopyIcon", Ptr, hCursor, Ptr)  {
VarSetCapacity(ICONINFO, 4*2 + A_PtrSize*3, 0)
DllCall("GetIconInfo", Ptr, hCursor, Ptr, &ICONINFO)
bIcon    := NumGet(ICONINFO, "UInt")
xHotspot := NumGet(ICONINFO, 4, "UInt")
yHotspot := NumGet(ICONINFO, 4*2, "UInt")
hBMMask  := NumGet(ICONINFO, 4*2 + A_PtrSize)
hBMColor := NumGet(ICONINFO, 4*2 + A_PtrSize*2)
DllCall("DrawIcon", Ptr, hDC, Int, xCursor - xHotspot - x, Int, yCursor - yHotspot - y, Ptr, hCursor)
DllCall("DestroyIcon", Ptr, hCursor)
( hBMMask && DllCall("DeleteObject", Ptr, hBMMask) )
( hBMColor && DllCall("DeleteObject", Ptr, hBMColor) )
}
}
DrawText(hDC, options)  {
static WM_CTLCOLORSTATIC := 0x138, WM_GETFONT := 0x31, TRANSPARENT := 1
, DT_NOCLIP := 0x100, DT_CENTER := 0x1, DT_RIGHT := 0x2, DT_LEFT := 0
Gui, New, +hwndhGui
Gui, Font, % options.fontOptions, % options.fontFamily
Gui, Add, Text, % options.textOptions . " hwndhText", % options.text
hTextDC := DllCall("GetDC", Ptr, hText, Ptr)
DllCall("SendMessage", Ptr, hGui, UInt, WM_CTLCOLORSTATIC, Ptr, hTextDC, Ptr, hText)
clr := DllCall("GetTextColor", Ptr, hTextDC)
DllCall("ReleaseDC", Ptr, 0, Ptr, hTextDC)
hFont := DllCall("SendMessage", Ptr, hText, UInt, WM_GETFONT, Ptr, 0, Ptr, 0, Ptr)
Gui, Destroy
obj := DllCall("SelectObject", Ptr, hDC, Ptr, hFont, Ptr)
DllCall("SetBkMode", Ptr, hDC, Int, TRANSPARENT)
DllCall("SetTextColor", Ptr, hDC, UInt, clr)
RegExMatch(options.textOptions, "i)(^|\s)\Kx(?<X>\d+)", text)
RegExMatch(options.textOptions, "i)(^|\s)\Ky(?<Y>\d+)", text)
RegExMatch(options.textOptions, "i)(^|\s)\Kw(?<W>\d+)", text)
left  := textX = "" ? 0 : textX
top   := textY = "" ? 0 : textY
right := textW = "" ? left : left + textW
VarSetCapacity(RECT, 16, 0)
NumPut(left  , RECT, 0)
NumPut(top   , RECT, 4)
NumPut(right , RECT, 8)
RegExMatch(options.textOptions, "i)(^|\s)\K(?<Align>right|center)", text)
align := {right: DT_RIGHT, center: DT_CENTER, "": DT_LEFT}[textAlign]
DllCall("DrawText", Ptr, hDC, Str, options.text, Int, -1, Ptr, &RECT, UInt, DT_NOCLIP|align)
DllCall("SelectObject", Ptr, hDC, Ptr, obj, Ptr)
DllCall("DeleteObject", Ptr, hFont)
}
class GDIplus   {
__New()  {
if !DllCall("GetModuleHandle", Str, "gdiplus", Ptr)
DllCall("LoadLibrary", Str, "gdiplus")
VarSetCapacity(si, A_PtrSize = 8 ? 24 : 16, 0), si := Chr(1)
DllCall("gdiplus\GdiplusStartup", PtrP, pToken, Ptr, &si, Ptr, 0)
this.token := pToken
}
__Delete()  {
DllCall("gdiplus\GdiplusShutdown", Ptr, this.token)
if hModule := DllCall("GetModuleHandle", Str, "gdiplus", Ptr)
DllCall("FreeLibrary", Ptr, hModule)
}
BitmapFromHBitmap(hBitmap, Palette := 0)  {
DllCall("gdiplus\GdipCreateBitmapFromHBITMAP", Ptr, hBitmap, Ptr, Palette, PtrP, pBitmap)
return pBitmap
}
SaveBitmapToFile(pBitmap, sOutput, Quality=75)  {
SplitPath, sOutput,,, Extension
if Extension not in BMP,DIB,RLE,JPG,JPEG,JPE,JFIF,GIF,TIF,TIFF,PNG
return -1
DllCall("gdiplus\GdipGetImageEncodersSize", UIntP, nCount, UIntP, nSize)
VarSetCapacity(ci, nSize)
DllCall("gdiplus\GdipGetImageEncoders", UInt, nCount, UInt, nSize, Ptr, &ci)
if !(nCount && nSize)
return -2
Loop, % nCount  {
sString := StrGet(NumGet(ci, (idx := (48+7*A_PtrSize)*(A_Index-1))+32+3*A_PtrSize), "UTF-16")
if !InStr(sString, "*." Extension)
continue
pCodec := &ci+idx
break
}
if !pCodec
return -3
if RegExMatch(Extension, "i)^J(PG|PEG|PE|FIF)$") && Quality != 75  {
DllCall("gdiplus\GdipGetEncoderParameterListSize", Ptr, pBitmap, Ptr, pCodec, UintP, nSize)
VarSetCapacity(EncoderParameters, nSize, 0)
DllCall("gdiplus\GdipGetEncoderParameterList", Ptr, pBitmap, Ptr, pCodec, UInt, nSize, Ptr, &EncoderParameters)
Loop, % NumGet(EncoderParameters, "UInt")  {
elem := (24+A_PtrSize)*(A_Index-1) + 4 + (pad := A_PtrSize = 8 ? 4 : 0)
if (NumGet(EncoderParameters, elem+16, "UInt") = 1) && (NumGet(EncoderParameters, elem+20, "UInt") = 6)  {
p := elem+&EncoderParameters-pad-4
NumPut(Quality, NumGet(NumPut(4, NumPut(1, p+0)+20, "UInt")), "UInt")
break
}
}
}
if A_IsUnicode
pOutput := &sOutput
else  {
VarSetCapacity(wOutput, StrPut(sOutput, "UTF-16")*2, 0)
StrPut(sOutput, &wOutput, "UTF-16")
pOutput := &wOutput
}
E := DllCall("gdiplus\GdipSaveImageToFile", Ptr, pBitmap, Ptr, pOutput, Ptr, pCodec, UInt, p ? p : 0)
return E ? -5 : 0
}
DisposeImage(pBitmap)  {
return DllCall("gdiplus\GdipDisposeImage", Ptr, pBitmap)
}
}
Return




; Горячие клавиши для изменения статуса
:?:/Онл:: ; Ctrl + 1 — для "Онлайн"
    ChangeStatus("1")
    Return

:?:/Афк:: ; Ctrl + 2 — для "Афк"
    ChangeStatus("2")
    Return

:?:/Офф::  ; Ctrl + 3 — для "Оффлайн"
    ChangeStatus("0")
    Return

; Функция для изменения статуса через консоль
ChangeStatus(Status) {
    ; Открываем Microsoft Edge с нужным URL
    Run, msedge.exe https://journal.gtajournal.online/dashboard
    WinWait, GTA Journal ; Ждем, пока окно не откроется
    Sleep, 100 ; Ожидаем 5 секунд для полной загрузки страницы

    ; Разворачиваем окно браузера
    WinMaximize, GTA Journal
    Sleep, 100  ; Ждем немного, чтобы окно точно развернулось

    ; Фокусируемся на окне браузера
    WinActivate, GTA Journal
    Sleep, 100  ; Подождем немного, чтобы окно точно получило фокус

    ; Открытие консоли браузера (Ctrl + Shift + J)
    Send, ^+j  ; Ctrl + Shift + J для открытия консоли
    Sleep, 300  ; Ждем 2 секунды, пока консоль откроется

    ; Клик перед выполнением jsCode (поменяйте на подходящие координаты для клика)
    Click, 1800, 500
    Sleep, 300  ; Ждем, чтобы клик успел выполниться

    ; Формируем JavaScript для изменения статуса
    jsCode := ""
    if (Status = "1") {
        jsCode := "document.querySelector('.action-status .online').click();"
    } else if (Status = "2") {
        jsCode := "document.querySelector('.action-status .afk').click();"
    } else if (Status = "0") {
        jsCode := "document.querySelector('.action-status .offline').click();"
    }

    ; Отправляем JavaScript в консоль и нажимаем Enter
    Send, % jsCode
    Send, {Enter}

    ; Ждем некоторое время, чтобы статус изменился
    Sleep, 200 ; Ждем 2 секунды

    ; Закрытие консоли (Ctrl + Shift + J)
    Send, ^+j
    Sleep, 100  ; Ждем, чтобы консоль закрылась

    ; Закрытие браузера
    ; Попробуем сначала закрыть окно
    WinClose, GTA Journal
    Sleep, 50 ; Ждем 2 секунды, чтобы окно успело закрыться

    ; Если браузер не закрылся, то принудительно завершаем процесс
    Process, Close, msedge.exe
}


Lektsii_MZ:
SoundPlay,   C:\ProgramData\KPRP\KPRP-main\muzyka_14.mp3
#Include *i C:\ProgramData\KPRP\KPRP-main\LecturesMZ.ahk
